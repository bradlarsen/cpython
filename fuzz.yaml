base: ubuntu:16.04

setup: # global setup steps here
- sudo apt-get update
- sudo apt-get install build-essential
- ./configure --with-address-sanitizer --with-assertions --with-pydebug
- make
- make install

environment: # global env vars here

targets:

- name: marshal-loads
  language: c
  setup:
  - $FUZZ_CC $CFLAGS fuzz/tests/marshal-loads/src/target.c -c -o fuzz/tests/marshal-loads/target.o
  - $FUZZ_CXX $CXXFLAGS fuzz/tests/marshal-loads/target.o $FUZZ_ENGINE -o fuzz/tests/marshal-loads/target
  corpus: fuzz/tests/marshal-loads/corpus
  harness:
    binary: fuzz/tests/marshal-loads/target
  sanitizers:
    address: detect_stack_use_after_return=1
